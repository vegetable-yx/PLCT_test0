+ source /root/GitRepo/mugen-riscv/libs/locallibs/common_lib.sh
++ python3 --version
++ '[' 0 -eq 0 ']'
++ source /root/GitRepo/mugen-riscv/libs/locallibs/common_lib_python.sh
+ main
++ type -t post_test
+ '[' -n function ']'
+ trap post_test EXIT INT HUP TERM
+ rpm -qa
+ grep expect
++ type -t config_params
+ '[' -n '' ']'
++ type -t pre_test
+ '[' -n function ']'
+ pre_test
+ LOG_INFO 'Start to prepare the database config.'
+ message='Start to prepare the database config.'
+ python3 /root/GitRepo/mugen-riscv/libs/locallibs/mugen_log.py --level info --message 'Start to prepare the database config.'
Thu Jan  5 23:01:36 2023 - INFO  - Start to prepare the database config.
+ DNF_INSTALL clamav
+ pkgs=clamav
+ node=1
+ '[' -z '' ']'
+ tmpfile=
++ python3 /root/GitRepo/mugen-riscv/libs/locallibs/rpm_manage.py install --pkgs clamav --node 1 --tempfile ''
+ tmpfile2=/tmp/tmp4qkzq9pg
+ '[' -z '' ']'
+ tmpfile=/tmp/tmp4qkzq9pg
+ LOG_INFO 'End to prepare the database config.'
+ message='End to prepare the database config.'
+ python3 /root/GitRepo/mugen-riscv/libs/locallibs/mugen_log.py --level info --message 'End to prepare the database config.'
Thu Jan  5 23:04:54 2023 - INFO  - End to prepare the database config.
++ type -t run_test
+ '[' -n function ']'
+ run_test
+ LOG_INFO 'Start to run test.'
+ message='Start to run test.'
+ python3 /root/GitRepo/mugen-riscv/libs/locallibs/mugen_log.py --level info --message 'Start to run test.'
Thu Jan  5 23:04:55 2023 - INFO  - Start to run test.
+ clamconf -g clamd.d/scan.conf
##
## clamd.d/scan.conf - automatically generated by clamconf 0.103.6
##

# Comment out or remove the line below.
Example

# 
# Default: no
#AlertExceedsMax 

# Enable prelude
# Default: no
#PreludeEnable 

# Name of the analyzer as seen in prewikka
# Default: disabled
#PreludeAnalyzerName 

# Save all reports to a log file.
# Default: disabled
#LogFile /tmp/clamav.log

# By default the log file is locked for writing and only a single
# daemon process can write to it. This option disables the lock.
# Default: no
#LogFileUnlock yes

# Maximum size of the log file.
# Value of 0 disables the limit.
# You may use 'M' or 'm' for megabytes (1M = 1m = 1048576 bytes)
# and 'K' or 'k' for kilobytes (1K = 1k = 1024 bytes). To specify the size
# in bytes just don't use modifiers.
# Default: 1048576
#LogFileMaxSize 5M

# Log time with each message.
# Default: no
#LogTime yes

# Log all clean files.
# Useful in debugging but drastically increases the log size.
# Default: no
#LogClean yes

# Use the system logger (can work together with LogFile).
# Default: no
#LogSyslog yes

# Type of syslog messages.
# Please refer to 'man syslog' for the facility names.
# Default: LOG_LOCAL6
#LogFacility LOG_MAIL

# Enable verbose logging.
# Default: no
#LogVerbose yes

# Rotate log file. Requires LogFileMaxSize option set prior to this option.
# Default: no
#LogRotate yes

# Log additional information about the infected file, such as its
# size and hash, together with the virus name.
# Default: no
#ExtendedDetectionInfo yes

# Save the process ID to a file.
# Default: disabled
#PidFile /var/run/clam.pid

# This option allows you to change the default temporary directory.
# Default: disabled
#TemporaryDirectory /tmp

# This option allows you to change the default database directory.
# If you enable it, please make sure it points to the same directory in
# both clamd and freshclam.
# Default: /var/lib/clamav
#DatabaseDirectory /var/lib/clamav

# Only load the official signatures published by the ClamAV project.
# Default: no
#OfficialDatabaseOnly no

# Path to a local socket file the daemon will listen on.
# Default: disabled
#LocalSocket /tmp/clamd.socket

# Sets the group ownership on the unix socket.
# Default: disabled
#LocalSocketGroup virusgroup

# Sets the permissions on the unix socket to the specified mode.
# Default: disabled
#LocalSocketMode 660

# Remove a stale socket after unclean shutdown
# Default: yes
#FixStaleSocket yes

# A TCP port number the daemon will listen on.
# Default: disabled
#TCPSocket 3310

# By default clamd binds to INADDR_ANY.
# This option allows you to restrict the TCP address and provide
# some degree of protection from the outside world.
# Default: disabled
#TCPAddr localhost

# Maximum length the queue of pending connections may grow to.
# Default: 200
#MaxConnectionQueueLength 30

# Close the STREAM session when the data size limit is exceeded.
# The value should match your MTA's limit for the maximum attachment size.
# You may use 'M' or 'm' for megabytes (1M = 1m = 1048576 bytes)
# and 'K' or 'k' for kilobytes (1K = 1k = 1024 bytes). To specify the size
# in bytes just don't use modifiers.
# Default: 26214400
#StreamMaxLength 25M

# The STREAM command uses an FTP-like protocol.
# This option sets the lower boundary for the port range.
# Default: 1024
#StreamMinPort 1024

# This option sets the upper boundary for the port range.
# Default: 2048
#StreamMaxPort 2048

# Maximum number of threads running at the same time.
# Default: 10
#MaxThreads 20

# This option specifies the time (in seconds) after which clamd should
# timeout if a client doesn't provide any data.
# Default: 120
#ReadTimeout 120

# This option specifies the time (in seconds) after which clamd should
# timeout if a client doesn't provide any initial command after connecting.
# Default: 30
#CommandReadTimeout 30

# This option specifies how long to wait (in milliseconds) if the send buffer
# is full. Keep this value low to prevent clamd hanging.
# Default: 500
#SendBufTimeout 200

# Maximum number of queued items (including those being processed by MaxThreads
# threads). It is recommended to have this value at least twice MaxThreads
# if possible.
# WARNING: you shouldn't increase this too much to avoid running out of file
#  descriptors, the following condition should hold:
#  MaxThreads*MaxRecursion + MaxQueue - MaxThreads  + 6 < RLIMIT_NOFILE
#  (usual max for RLIMIT_NOFILE is 1024)
# 
# Default: 100
#MaxQueue 200

# This option specifies how long (in seconds) the process should wait
# for a new job.
# Default: 30
#IdleTimeout 60

# Don't scan files/directories whose names match the provided
# regular expression. This option can be specified multiple times.
# Default: disabled
#ExcludePath ^/proc/
#ExcludePath ^/sys/

# Maximum depth the directories are scanned at.
# Default: 15
#MaxDirectoryRecursion 15

# Follow directory symlinks.
# Default: no
#FollowDirectorySymlinks no

# Follow symlinks to regular files.
# Default: no
#FollowFileSymlinks no

# Scan files and directories on other filesystems.
# Default: yes
#CrossFilesystems yes

# This option specifies the time intervals (in seconds) in which clamd
# should perform a database check.
# Default: 600
#SelfCheck 600

# Enable non-blocking (multi-threaded/concurrent) database reloads. This feature 
# will temporarily load a second scanning engine while scanning continues using 
# the first engine. Once loaded, the new engine takes over. The old engine is 
# removed as soon as all scans using the old engine have completed. This feature 
# requires more RAM, so this option is provided in case users are willing to 
# block scans during reload in exchange for lower RAM requirements.
# Default: yes
#ConcurrentDatabaseReload yes

# This option allows you to disable clamd's caching feature.
# Default: no
#DisableCache no

# Execute a command when a virus is found. In the command string %v will be
# replaced with the virus name. Additionally, two environment variables will
# be defined: $CLAM_VIRUSEVENT_FILENAME and $CLAM_VIRUSEVENT_VIRUSNAME.
# Default: disabled
#VirusEvent /usr/bin/mailx -s "ClamAV VIRUS ALERT: %v" alert < /dev/null

# Stop the daemon when libclamav reports an out of memory condition.
# Default: no
#ExitOnOOM yes

# Permit use of the ALLMATCHSCAN command.
# Default: yes
#AllowAllMatchScan yes

# Don't fork into background.
# Default: no
#Foreground no

# Enable debug messages in libclamav.
# Default: no
#Debug no

# Don't remove temporary files (for debugging purposes).
# Default: no
#LeaveTemporaryFiles no

# Run the daemon as a specified user (the process must be started by root).
# Default: disabled
#User clamav

# With this option enabled ClamAV will load bytecode from the database. It is highly recommended you keep this option on, otherwise you'll miss detections for many new viruses.
# Default: yes
#Bytecode yes

# Set bytecode security level.
# Possible values:
# 	TrustSigned - trust bytecode loaded from signed .c[lv]d files,
# 		 insert runtime safety checks for bytecode loaded from other sources
# 	Paranoid - don't trust any bytecode, insert runtime checks for all
# Recommended: TrustSigned, because bytecode in .cvd files already has these checks.
# Default: TrustSigned
#BytecodeSecurity TrustSigned

# Set bytecode timeout in milliseconds.
# Default: 10000
#BytecodeTimeout 10000

# Allow loading bytecode from outside digitally signed .c[lv]d files.
# Default: no
#BytecodeUnsigned no

# Set bytecode execution mode.
# Possible values:
# 	Auto - automatically choose JIT if possible, fallback to interpreter
# ForceJIT - always choose JIT, fail if not possible
# ForceInterpreter - always choose interpreter
# Test - run with both JIT and interpreter and compare results. Make all failures fatal.
# Default: Auto
#BytecodeMode Auto

# Detect Potentially Unwanted Applications.
# Default: no
#DetectPUA yes

# Exclude a specific PUA category. This directive can be used multiple times.
# See https://docs.clamav.net/faq/faq-pua.html for the complete list of PUA
# categories.
# Default: disabled
#ExcludePUA NetTool
#ExcludePUA PWTool

# Only include a specific PUA category. This directive can be used multiple
# times.
# Default: disabled
#IncludePUA Spy
#IncludePUA Scanner
#IncludePUA RAT

# PE stands for Portable Executable - it's an executable file format used
# in all 32- and 64-bit versions of Windows operating systems. This option
# allows ClamAV to perform a deeper analysis of executable files and it's also
# required for decompression of popular executable packers such as UPX or FSG.
# If you turn off this option, the original files will still be scanned, but
# without additional processing.
# Default: yes
#ScanPE yes

# Executable and Linking Format is a standard format for UN*X executables.
# This option allows you to control the scanning of ELF files.
# If you turn off this option, the original files will still be scanned, but
# without additional processing.
# Default: yes
#ScanELF yes

# Enable the built in email scanner.
# If you turn off this option, the original files will still be scanned, but
# without parsing individual messages/attachments.
# Default: yes
#ScanMail yes

# Scan RFC1341 messages split over many emails. You will need to
# periodically clean up $TemporaryDirectory/clamav-partial directory.
# WARNING: This option may open your system to a DoS attack. Please don't use
# this feature on highly loaded servers.
# Default: no
#ScanPartialMessages no

# With this option enabled ClamAV will try to detect phishing attempts by using
# signatures.
# Default: yes
#PhishingSignatures yes

# Scan URLs found in mails for phishing attempts using heuristics.
# Default: yes
#PhishingScanURLs yes

# In some cases (eg. complex malware, exploits in graphic files, and others),
# ClamAV uses special algorithms to provide accurate detection. This option
# controls the algorithmic detection.
# Default: yes
#HeuristicAlerts yes

# Allow heuristic match to take precedence.
# When enabled, if a heuristic scan (such as phishingScan) detects
# a possible virus/phish it will stop scan immediately. Recommended, saves CPU
# scan-time.
# When disabled, virus/phish detected by heuristic scans will be reported only
# at the end of a scan. If an archive contains both a heuristically detected
# virus/phish, and a real malware, the real malware will be reported.
# Keep this disabled if you intend to handle "Heuristics.*" viruses
# differently from "real" malware.
# If a non-heuristically-detected virus (signature-based) is found first,
# the scan is interrupted immediately, regardless of this config option.
# Default: no
#HeuristicScanPrecedence yes

# Enable the Data Loss Prevention module.
# Default: no
#StructuredDataDetection no

# This option sets the lowest number of Credit Card numbers found in a file
# to generate a detect.
# Default: 3
#StructuredMinCreditCardCount 5

# This option sets the lowest number of Social Security Numbers found
# in a file to generate a detect.
# Default: 3
#StructuredMinSSNCount 5

# With this option enabled the DLP module will search for valid
# SSNs formatted as xxx-yy-zzzz.
# Default: yes
#StructuredSSNFormatNormal yes

# With this option enabled the DLP module will search for valid
# SSNs formatted as xxxyyzzzz
# Default: no
#StructuredSSNFormatStripped no

# Perform HTML/JavaScript/ScriptEncoder normalisation and decryption.
# If you turn off this option, the original files will still be scanned, but
# without additional processing.
# Default: yes
#ScanHTML yes

# This option enables scanning of OLE2 files, such as Microsoft Office
# documents and .msi files.
# If you turn off this option, the original files will still be scanned, but
# without additional processing.
# Default: yes
#ScanOLE2 yes

# With this option enabled clamav will try to detect broken executables
# (PE, ELF, & Mach-O) and alert on them with a Broken.Executable heuristic signature.
# Default: no
#AlertBrokenExecutables yes

# With this option enabled clamav will try to detect broken media files
# (JPEG, TIFF, PNG, GIF) and alert on them with a Broken.Media heuristic signature.
# Default: no
#AlertBrokenMedia yes

# Alert on encrypted archives and documents (encrypted .zip, .7zip, .rar, .pdf).
# Default: no
#AlertEncrypted no

# With this option enabled the DLP module will search for valid Credit Card
# numbers only. Debit and Private Label cards will not be searched.
# Default: no
#StructuredCCOnly no

# Alert on encrypted archives (encrypted .zip, .7zip, .rar).
# Default: no
#AlertEncryptedArchive no

# Alert on encrypted documents (encrypted .pdf).
# Default: no
#AlertEncryptedDoc no

# With this option enabled OLE2 files with VBA macros, which were not
# detected by signatures will be marked as "Heuristics.OLE2.ContainsMacros".
# Default: no
#AlertOLE2Macros no

# Alert on SSL mismatches in URLs, even if they're not in the database.
# This feature can lead to false positives.
# Default: no
#AlertPhishingSSLMismatch 

# Alert on cloaked URLs, even if they're not in the database.
# This feature can lead to false positives.
# Default: no
#AlertPhishingCloak no

# Alert on raw DMG image files containing partition intersections.
# Default: no
#AlertPartitionIntersection yes

# This option enables scanning within PDF files.
# If you turn off this option, the original files will still be scanned, but
# without decoding and additional processing.
# Default: yes
#ScanPDF yes

# This option enables scanning within SWF files.
# If you turn off this option, the original files will still be scanned, but
# without decoding and additional processing.
# Default: yes
#ScanSWF yes

# This option enables scanning xml-based document files supported by libclamav.
# If you turn off this option, the original files will still be scanned, but
# without additional processing.
# Default: yes
#ScanXMLDOCS yes

# This option enables scanning HWP3 files.
# If you turn off this option, the original files will still be scanned, but
# without additional processing.
# Default: yes
#ScanHWP3 yes

# Scan within archives and compressed files.
# If you turn off this option, the original files will still be scanned, but
# without unpacking and additional processing.
# Default: yes
#ScanArchive yes

# This option causes memory or nested map scans to dump the content to disk.
# If you turn on this option, more data is written to disk and is available
# when the leave-temps option is enabled at the cost of more disk writes.
# Default: no
#ForceToDisk no

# This option sets the maximum amount of time a scan may take to complete.
# The value of 0 disables the limit.
# WARNING: disabling this limit or setting it too high may result allow scanning
# of certain files to lock up the scanning process/threads resulting in a Denial of Service.
# The value is in milliseconds.
# Default: 0
#MaxScanTime 120000

# This option sets the maximum amount of data to be scanned for each input file.
# Archives and other containers are recursively extracted and scanned up to this
# value.
# The value of 0 disables the limit.
# WARNING: disabling this limit or setting it too high may result in severe
# damage.
# You may use 'M' or 'm' for megabytes (1M = 1m = 1048576 bytes)
# and 'K' or 'k' for kilobytes (1K = 1k = 1024 bytes). To specify the size
# in bytes just don't use modifiers.
# Default: 104857600
#MaxScanSize 100M

# Files/messages larger than this limit won't be scanned. Affects the input
# file itself as well as files contained inside it (when the input file is
# an archive, a document or some other kind of container).
# The value of 0 disables the limit.
# WARNING: disabling this limit or setting it too high may result in severe
# damage to the system.
# You may use 'M' or 'm' for megabytes (1M = 1m = 1048576 bytes)
# and 'K' or 'k' for kilobytes (1K = 1k = 1024 bytes). To specify the size
# in bytes just don't use modifiers.
# Default: 26214400
#MaxFileSize 25M

# Nested archives are scanned recursively, e.g. if a Zip archive contains a RAR
# file, all files within it will also be scanned. This option specifies how
# deeply the process should be continued.
# The value of 0 disables the limit.
# WARNING: disabling this limit or setting it too high may result in severe
# damage to the system.
# Default: 17
#MaxRecursion 17

# Number of files to be scanned within an archive, a document, or any other
# container file.
# The value of 0 disables the limit.
# WARNING: disabling this limit or setting it too high may result in severe
# damage to the system.
# Default: 10000
#MaxFiles 10000

# This option sets the maximum size of a file to check for embedded PE.
# Files larger than this value will skip the additional analysis step.
# Negative values are not allowed.
# WARNING: setting this limit too high may result in severe damage or impact performance.
# You may use 'M' or 'm' for megabytes (1M = 1m = 1048576 bytes)
# and 'K' or 'k' for kilobytes (1K = 1k = 1024 bytes). To specify the size
# in bytes just don't use modifiers.
# Default: 10485760
#MaxEmbeddedPE 10M

# This option sets the maximum size of a HTML file to normalize.
# HTML files larger than this value will not be normalized or scanned.
# Negative values are not allowed.
# WARNING: setting this limit too high may result in severe damage or impact performance.
# You may use 'M' or 'm' for megabytes (1M = 1m = 1048576 bytes)
# and 'K' or 'k' for kilobytes (1K = 1k = 1024 bytes). To specify the size
# in bytes just don't use modifiers.
# Default: 10485760
#MaxHTMLNormalize 10M

# This option sets the maximum size of a normalized HTML file to scan.
# HTML files larger than this value after normalization will not be scanned.
# Negative values are not allowed.
# WARNING: setting this limit too high may result in severe damage or impact performance.
# You may use 'M' or 'm' for megabytes (1M = 1m = 1048576 bytes)
# and 'K' or 'k' for kilobytes (1K = 1k = 1024 bytes). To specify the size
# in bytes just don't use modifiers.
# Default: 2097152
#MaxHTMLNoTags 2M

# This option sets the maximum size of a script file to normalize.
# Script content larger than this value will not be normalized or scanned.
# Negative values are not allowed.
# WARNING: setting this limit too high may result in severe damage or impact performance.
# You may use 'M' or 'm' for megabytes (1M = 1m = 1048576 bytes)
# and 'K' or 'k' for kilobytes (1K = 1k = 1024 bytes). To specify the size
# in bytes just don't use modifiers.
# Default: 5242880
#MaxScriptNormalize 5M

# This option sets the maximum size of a ZIP file to reanalyze type recognition.
# ZIP files larger than this value will skip the step to potentially reanalyze as PE.
# Negative values are not allowed.
# WARNING: setting this limit too high may result in severe damage or impact performance.
# You may use 'M' or 'm' for megabytes (1M = 1m = 1048576 bytes)
# and 'K' or 'k' for kilobytes (1K = 1k = 1024 bytes). To specify the size
# in bytes just don't use modifiers.
# Default: 1048576
#MaxZipTypeRcg 1M

# This option sets the maximum number of partitions of a raw disk image to be scanned.
# Raw disk images with more partitions than this value will have up to the value number partitions scanned.
# Negative values are not allowed.
# WARNING: setting this limit too high may result in severe damage or impact performance.
# Default: 50
#MaxPartitions 128

# This option sets the maximum number of icons within a PE to be scanned.
# PE files with more icons than this value will have up to the value number icons scanned.
# Negative values are not allowed.
# WARNING: setting this limit too high may result in severe damage or impact performance.
# Default: 100
#MaxIconsPE 100

# This option sets the maximum recursive calls to HWP3 parsing function.
# HWP3 files using more than this limit will be terminated and alert the user.
# Scans will be unable to scan any HWP3 attachments if the recursive limit is reached.
# Negative values are not allowed.
# WARNING: setting this limit too high may result in severe damage or impact performance.
# Default: 16
#MaxRecHWP3 16

# This option sets the maximum calls to the PCRE match function during an instance of regex matching.
# Instances using more than this limit will be terminated and alert the user but the scan will continue.
# For more information on match_limit, see the PCRE documentation.
# Negative values are not allowed.
# WARNING: setting this limit too high may severely impact performance.
# Default: 100000
#PCREMatchLimit 100000

# This option sets the maximum recursive calls to the PCRE match function during an instance of regex matching.
# Instances using more than this limit will be terminated and alert the user but the scan will continue.
# For more information on match_limit_recursion, see the PCRE documentation.
# Negative values are not allowed and values > PCREMatchLimit are superfluous.
# WARNING: setting this limit too high may severely impact performance.
# Default: 2000
#PCRERecMatchLimit 5000

# This option sets the maximum filesize for which PCRE subsigs will be executed.
# Files exceeding this limit will not have PCRE subsigs executed unless a subsig is encompassed to a smaller buffer.
# Negative values are not allowed.
# Setting this value to zero disables the limit.
# WARNING: setting this limit too high or disabling it may severely impact performance.
# You may use 'M' or 'm' for megabytes (1M = 1m = 1048576 bytes)
# and 'K' or 'k' for kilobytes (1K = 1k = 1024 bytes). To specify the size
# in bytes just don't use modifiers.
# Default: 26214400
#PCREMaxFileSize 25M

# This option specifies a directory or mount point which should be scanned on access. The mount point specified, or the mount point containing the specified directory will be watched, but only notifications will occur. If any directories are specified, this option will preempt the DDD system. It can also be used multiple times.
# Default: disabled
#OnAccessMountPath /
#OnAccessMountPath /home/user

# This option specifies a directory (including all files and directories
# inside it), which should be scanned on access. This option can
# be used multiple times.
# Default: disabled
#OnAccessIncludePath /home
#OnAccessIncludePath /students

# This option allows excluding directories from on-access scanning. It can
# be used multiple times. Only works with DDD system.
# Default: disabled
#OnAccessExcludePath /home/bofh
#OnAccessExcludePath /root

# Use this option to whitelist the root UID (0) and allow any processes run under root to access all watched files without triggering scans.
# Default: disabled
#OnAccessExcludeRootUID no

# With this option you can whitelist specific UIDs. Processes with these UIDs
# will be able to access all files.
# This option can be used multiple times (one per line). Using a value of 0 on any line will disable this option entirely. To whitelist the root UID please enable the OnAccessExcludeRootUID option.
# Default: disabled
#OnAccessExcludeUID 0

# This option allows exclusions via user names when using the on-access scanning client. It can
# be used multiple times.
# Default: disabled
#OnAccessExcludeUname clamuser

# Files larger than this value will not be scanned in on access.
# You may use 'M' or 'm' for megabytes (1M = 1m = 1048576 bytes)
# and 'K' or 'k' for kilobytes (1K = 1k = 1024 bytes). To specify the size
# in bytes just don't use modifiers.
# Default: 5242880
#OnAccessMaxFileSize 5M

# This option toggles the dynamic directory determination system for on-access scanning (Linux only).
# Default: no
#OnAccessDisableDDD no

# This option changes fanotify behavior to prevent access attempts on malicious files instead of simply notifying the user (On Access scan only).
# Default: no
#OnAccessPrevention yes

# Enables extra scanning and notification after catching certain inotify events. Only works with the DDD system enabled.
# Default: no
#OnAccessExtraScanning yes

# Max amount of time (in milliseconds) that the OnAccess client should spend for every connect, send, and recieve attempt when communicating with clamd via curl (5s default)
# Default: 5000
#OnAccessCurlTimeout 10000L

# Max number of scanning threads to allocate to the OnAccess thread pool at startup--these threads are the ones responsible for creating a connection with the daemon and kicking off scanning after an event has been processed. To prevent clamonacc from consuming all clamd's resources keep this lower than clamd's max threads. Default is 5
# Default: 5
#OnAccessMaxThreads 10

# Number of times the OnAccess client will retry a failed scan due to connection problems (or other issues). Defaults to no retries.
# Default: 0
#OnAccessRetryAttempts 3

# When using prevention, if this option is turned on, any errors that occur during scanning will result in the event attempt being denied. This could potentially lead to unwanted system behaviour with certain configurations, so the client defaults to off and allowing access events in case of error.
# Default: no
#OnAccessDenyOnError yes

# Disable authenticode certificate chain verification in PE files.
# Default: no
#DisableCertCheck no

# Deprecated option to enable heuristic alerts (e.g. "Heuristics.<sig name>")
# Default: yes
#AlgorithmicDetection no

# 
# Default: no
#BlockMax 

# Deprecated option to alert on SSL mismatches in URLs, even if they're not in the database.
# This feature can lead to false positives.
# Default: no
#PhishingAlwaysBlockSSLMismatch no

# Deprecated option to alert on cloaked URLs, even if they're not in the database.
# This feature can lead to false positives.
# Default: no
#PhishingAlwaysBlockCloak no

# Deprecated option to alert on raw DMG image files containing partition intersections.
# Default: no
#PartitionIntersection no

# With this option enabled OLE2 files with VBA macros, which were not
# detected by signatures will be marked as "Heuristics.OLE2.ContainsMacros".
# Default: no
#OLE2BlockMacros no

# Deprecated option to alert on encrypted archives and documents (encrypted .zip, .7zip, .rar, .pdf).
# Default: no
#ArchiveBlockEncrypted no
+ CHECK_RESULT 0 0 0 'Execute clamconf -g clamd.d/scan.conf failed.'
+ actual_result=0
+ expect_result=0
+ mode=0
+ error_log='Execute clamconf -g clamd.d/scan.conf failed.'
+ '[' -z 0 ']'
+ '[' 0 -eq 0 ']'
+ test 0x '!=' 0x
+ return 0
+ clamconf -g freshclam.conf
##
## freshclam.conf - automatically generated by clamconf 0.103.6
##

# Comment out or remove the line below.
Example

# Maximum size of the log file.
# Value of 0 disables the limit.
# You may use 'M' or 'm' for megabytes (1M = 1m = 1048576 bytes)
# and 'K' or 'k' for kilobytes (1K = 1k = 1024 bytes). To specify the size
# in bytes just don't use modifiers.
# Default: 1048576
#LogFileMaxSize 5M

# Log time with each message.
# Default: no
#LogTime yes

# Use the system logger (can work together with LogFile).
# Default: no
#LogSyslog yes

# Type of syslog messages.
# Please refer to 'man syslog' for the facility names.
# Default: LOG_LOCAL6
#LogFacility LOG_MAIL

# Enable verbose logging.
# Default: no
#LogVerbose yes

# Rotate log file. Requires LogFileMaxSize option set prior to this option.
# Default: no
#LogRotate yes

# Save the process ID to a file.
# Default: disabled
#PidFile /var/run/clam.pid

# This option allows you to change the default database directory.
# If you enable it, please make sure it points to the same directory in
# both clamd and freshclam.
# Default: /var/lib/clamav
#DatabaseDirectory /var/lib/clamav

# Don't fork into background.
# Default: no
#Foreground no

# Enable debug messages in libclamav.
# Default: no
#Debug no

# Save all reports to a log file.
# Default: disabled
#UpdateLogFile /var/log/freshclam.log

# When started by root freshclam will drop privileges and switch to the user
# defined in this option.
# Default: clamav
#DatabaseOwner clamav

# This option defined how many times daily freshclam should check for
# a database update.
# Default: 12
#Checks 24

# Use DNS to verify the virus database version. FreshClam uses DNS TXT records
# to verify the versions of the database and software itself. With this
# directive you can change the database verification domain.
# WARNING: Please don't change it unless you're configuring freshclam to use
# your own database verification domain.
# Default: current.cvd.clamav.net
#DNSDatabaseInfo current.cvd.clamav.net

# DatabaseMirror specifies to which mirror(s) freshclam should connect.
# You should have at least one entry: database.clamav.net.
# Default: disabled
#DatabaseMirror database.clamav.net

# This option allows you to easily point freshclam to private mirrors.
# If PrivateMirror is set, freshclam does not attempt to use DNS
# to determine whether its databases are out-of-date, instead it will
# use the If-Modified-Since request or directly check the headers of the
# remote database files. For each database, freshclam first attempts
# to download the CLD file. If that fails, it tries to download the
# CVD file. This option overrides DatabaseMirror, DNSDatabaseInfo
# and Scripted Updates. It can be used multiple times to provide
# fall-back mirrors.
# Default: disabled
#PrivateMirror mirror1.mynetwork.com
#PrivateMirror mirror2.mynetwork.com

# This option defines how many attempts freshclam should make before giving up.
# Default: 3
#MaxAttempts 5

# With this option you can control scripted updates. It's highly recommended to keep them enabled.
# Default: yes
#ScriptedUpdates yes

# With this option enabled, freshclam will attempt to load new
# databases into memory to make sure they are properly handled
# by libclamav before replacing the old ones. Tip: This feature uses a lot of RAM. If your system has limited RAM and you are actively running ClamD or ClamScan during the update, then you may need to set `TestDatabases no`.
# Default: yes
#TestDatabases yes

# By default freshclam will keep the local databases (.cld) uncompressed to
# make their handling faster. With this option you can enable the compression.
# The change will take effect with the next database update.
# Default: no
#CompressLocalDatabase 

# Include an optional signature databases (opt-in). This option can be used multiple times.
# Default: disabled
#ExtraDatabase dbname1
#ExtraDatabase dbname2

# Exclude a standard signature database (opt-out). This option can be used multiple times.
# Default: disabled
#ExcludeDatabase dbname1
#ExcludeDatabase dbname2

# With this option you can provide custom sources (http:// or file://) for database files.
# This option can be used multiple times.
# Default: disabled
#DatabaseCustomURL http://myserver.com/mysigs.ndb
#DatabaseCustomURL file:///mnt/nfs/local.hdb

# If you're behind a proxy, please enter its address here.
# Default: disabled
#HTTPProxyServer your-proxy

# HTTP proxy's port
# Default: disabled
#HTTPProxyPort 8080

# A user name for the HTTP proxy authentication.
# Default: disabled
#HTTPProxyUsername username

# A password for the HTTP proxy authentication.
# Default: disabled
#HTTPProxyPassword pass

# If your servers are behind a firewall/proxy which does a User-Agent
# filtering you can use this option to force the use of a different
# User-Agent header.
# Default: disabled
#HTTPUserAgent default

# Send the RELOAD command to clamd after a successful update.
# Default: /etc/clamd.d/scan.conf
#NotifyClamd yes

# Run a command after a successful database update. Use EXIT_1 to return 1 after successful database update.
# Default: disabled
#OnUpdateExecute command

# Run a command when a database update error occurs.
# Default: disabled
#OnErrorExecute command

# Run a command when freshclam reports an outdated version.
# In the command string %v will be replaced with the new version number.
# Default: disabled
#OnOutdatedExecute command

# With this option you can provide a client address for the database downloading.
# Useful for multi-homed systems.
# Default: disabled
#LocalIPAddress aaa.bbb.ccc.ddd

# Timeout in seconds when connecting to database server.
# Default: 30
#ConnectTimeout 30

# Maximum time in seconds for each download operation. 0 means no timeout.
# Default: 0
#ReceiveTimeout 0

# This option enables downloading of bytecode.cvd, which includes additional
# detection mechanisms and improvements to the ClamAV engine.
# Default: yes
#Bytecode yes
+ CHECK_RESULT 0 0 0 'Execute clamconf -g freshclam.conf failed.'
+ actual_result=0
+ expect_result=0
+ mode=0
+ error_log='Execute clamconf -g freshclam.conf failed.'
+ '[' -z 0 ']'
+ '[' 0 -eq 0 ']'
+ test 0x '!=' 0x
+ return 0
+ clamconf -g mail/clamav-milter.conf
##
## mail/clamav-milter.conf - automatically generated by clamconf 0.103.6
##

# Comment out or remove the line below.
Example

# Save all reports to a log file.
# Default: disabled
#LogFile /tmp/clamav.log

# By default the log file is locked for writing and only a single
# daemon process can write to it. This option disables the lock.
# Default: no
#LogFileUnlock yes

# Maximum size of the log file.
# Value of 0 disables the limit.
# You may use 'M' or 'm' for megabytes (1M = 1m = 1048576 bytes)
# and 'K' or 'k' for kilobytes (1K = 1k = 1024 bytes). To specify the size
# in bytes just don't use modifiers.
# Default: 1048576
#LogFileMaxSize 5M

# Log time with each message.
# Default: no
#LogTime yes

# Use the system logger (can work together with LogFile).
# Default: no
#LogSyslog yes

# Type of syslog messages.
# Please refer to 'man syslog' for the facility names.
# Default: LOG_LOCAL6
#LogFacility LOG_MAIL

# Enable verbose logging.
# Default: no
#LogVerbose yes

# Rotate log file. Requires LogFileMaxSize option set prior to this option.
# Default: no
#LogRotate yes

# Save the process ID to a file.
# Default: disabled
#PidFile /var/run/clam.pid

# This option allows you to change the default temporary directory.
# Default: disabled
#TemporaryDirectory /tmp

# Remove a stale socket after unclean shutdown
# Default: yes
#FixStaleSocket yes

# Maximum number of threads running at the same time.
# Default: 10
#MaxThreads 20

# Waiting for data from clamd will timeout after this time (seconds).
# Default: 120
#ReadTimeout 300

# Don't fork into background.
# Default: no
#Foreground no

# Run the daemon as a specified user (the process must be started by root).
# Default: disabled
#User clamav

# Files/messages larger than this limit won't be scanned. Affects the input
# file itself as well as files contained inside it (when the input file is
# an archive, a document or some other kind of container).
# The value of 0 disables the limit.
# WARNING: disabling this limit or setting it too high may result in severe
# damage to the system.
# You may use 'M' or 'm' for megabytes (1M = 1m = 1048576 bytes)
# and 'K' or 'k' for kilobytes (1K = 1k = 1024 bytes). To specify the size
# in bytes just don't use modifiers.
# Default: 26214400
#MaxFileSize 25M

# Define the clamd socket to connect to for scanning.
# This option is mandatory! Syntax:
#   ClamdSocket unix:path
#   ClamdSocket tcp:host:port
# The first syntax specifies a local unix socket (needs an absolute path) e.g.:
#   ClamdSocket unix:/var/run/clamd/clamd.socket
# The second syntax specifies a tcp local or remote tcp socket: the
# host can be a hostname or an ip address; the ":port" field is only required
# for IPv6 addresses, otherwise it defaults to 3310
#   ClamdSocket tcp:192.168.0.1
# This option can be repeated several times with different sockets or even
# with the same socket: clamd servers will be selected in a round-robin fashion.
# Default: disabled
#ClamdSocket tcp:scanner.mydomain:7357

# Define the interface through which we communicate with sendmail.
# This option is mandatory! Possible formats are:
# [[unix|local]:]/path/to/file - to specify a unix domain socket;
# inet:port@[hostname|ip-address] - to specify an ipv4 socket;
# inet6:port@[hostname|ip-address] - to specify an ipv6 socket.
# Default: disabled
#MilterSocket /tmp/clamav-milter.socket
#MilterSocket inet:7357

# Define the group ownership for the (unix) milter socket.
# Default: disabled
#MilterSocketGroup virusgroup

# Sets the permissions on the (unix) milter socket to the specified mode.
# Default: disabled
#MilterSocketMode 660

# Messages originating from these hosts/networks will not be scanned
# This option takes a host(name)/mask pair in CIRD notation and can be
# repeated several times. If "/mask" is omitted, a host is assumed.
# To specify a locally originated, non-smtp, email use the keyword "local".
# Default: disabled
#LocalNet local
#LocalNet 192.168.0.0/24
#LocalNet 1111:2222:3333::/48

# Action to be performed on clean messages (mostly useful for testing).
# The following actions are available:
# Accept: the message is accepted for delivery
# Reject: immediately refuse delivery (a 5xx error is returned to the peer)
# Defer: return a temporary failure message (4xx) to the peer
# Blackhole: like Accept but the message is sent to oblivion
# Quarantine: like Accept but message is quarantined instead of being delivered
# Default: Accept
#OnClean Accept

# Action to be performed on clean messages (mostly useful for testing).
# The following actions are available:
# Accept: the message is accepted for delivery
# Reject: immediately refuse delivery (a 5xx error is returned to the peer)
# Defer: return a temporary failure message (4xx) to the peer
# Blackhole: like Accept but the message is sent to oblivion
# Quarantine: like Accept but message is quarantined instead of being delivered
# Default: Quarantine
#OnInfected Quarantine

# Action to be performed on error conditions (this includes failure to
# allocate data structures, no scanners available, network timeouts, unknown
# scanner replies and the like.
# The following actions are available:
# Accept: the message is accepted for delivery;
# Reject: immediately refuse delivery (a 5xx error is returned to the peer);
# Defer: return a temporary failure message (4xx) to the peer.
# Default: Defer
#OnFail Defer

# This option allows you to set a specific rejection reason for infected messages
# and it's therefore only useful together with "OnInfected Reject"
# The string "%v", if present, will be replaced with the virus name.
# Default: disabled
#RejectMsg MTA specific

# If this option is set to "Replace" (or "Yes"), an "X-Virus-Scanned" and an
# "X-Virus-Status" headers will be attached to each processed message, possibly
# replacing existing headers.
# If it is set to Add, the X-Virus headers are added possibly on top of the
# existing ones.
# Note that while "Replace" can potentially break DKIM signatures, "Add" may
# confuse procmail and similar filters.
# Default: no
#AddHeader Replace

# When AddHeader is in use, this option allows you to set the reported
# hostname. This may be desirable in order to avoid leaking internal names.
# If unset the real machine name is used.
# Default: disabled
#ReportHostname my.mail.server.name

# Execute a command when an infected message is processed.
# The following parameters are passed to the invoked program in this order:
# virus name, queue id, sender, destination, subject, message id, message date.
# Note #1: this requires MTA macroes to be available (see LogInfected below)
# Note #2: the process is invoked in the context of clamav-milter
# Note #3: clamav-milter will wait for the process to exit. Be quick or fork to
# avoid unnecessary delays in email delivery
# Default: disabled
#VirusAction /usr/local/bin/my_infected_message_handler

# Chroot to the specified directory.
# Chrooting is performed just after reading the config file and before
# dropping privileges.
# Default: disabled
#Chroot /newroot

# This option specifies a file which contains a list of basic POSIX regular
# expressions. Addresses (sent to or from - see below) matching these regexes
# will not be scanned.  Optionally each line can start with the string "From:"
# or "To:" (note: no whitespace after the colon) indicating if it is,
# respectively, the sender or recipient that is to be whitelisted.
# If the field is missing, "To:" is assumed.
# Lines starting with #, : or ! are ignored.
# Default: disabled
#Whitelist /etc/whitelisted_addresses

# Messages from authenticated SMTP users matching this extended POSIX
# regular expression (egrep-like) will not be scanned.
# As an alternative, a file containing a plain (not regex) list of names (one
# per line) can be specified using the prefix "file:".
# e.g. SkipAuthenticated file:/etc/good_guys
# 
# Note: this is the AUTH login name!
# Default: disabled
#SkipAuthenticated SkipAuthenticated ^(tom|dick|henry)$

# This option allows you to tune what is logged when a message is infected.
# Possible values are Off (the default - nothing is logged),
# Basic (minimal info logged), Full (verbose info logged)
# Note:
# For this to work properly in sendmail, make sure the msg_id, mail_addr,
# rcpt_addr and i macroes are available in eom. In other words add a line like:
# Milter.macros.eom={msg_id}, {mail_addr}, {rcpt_addr}, i
# to your .cf file. Alternatively use the macro:
# define(`confMILTER_MACROS_EOM', `{msg_id}, {mail_addr}, {rcpt_addr}, i')
# Postfix should be working fine with the default settings.
# Default: disabled
#LogInfected Basic

# This option allows you to tune what is logged when no threat is found in a scanned message.
# See LogInfected for possible values and caveats.
# Useful in debugging but drastically increases the log size.
# Default: disabled
#LogClean Basic

# This option affects the behaviour of LogInfected, LogClean and VirusAction
# when a message with multiple recipients is scanned:
# If SupportMultipleRecipients is off (the default)
# then one single log entry is generated for the message and, in case the
# message is determined to be malicious, the command indicated by VirusAction
# is executed just once. In both cases only the last recipient is reported.
# If SupportMultipleRecipients is on:
# then one line is logged for each recipient and the command indicated
# by VirusAction is also executed once for each recipient.
# 
# Note: although it's probably a good idea to enable this option, the default value
# is currently set to off for legacy reasons.
# Default: no
#SupportMultipleRecipients yes
+ CHECK_RESULT 0 0 0 'Execute clamconf -g mail/clamav-milter.conf failed.'
+ actual_result=0
+ expect_result=0
+ mode=0
+ error_log='Execute clamconf -g mail/clamav-milter.conf failed.'
+ '[' -z 0 ']'
+ '[' 0 -eq 0 ']'
+ test 0x '!=' 0x
+ return 0
+ clamconf -c /etc/clamd.d/scan.conf
+ grep -i 'Build information'
Build information
+ CHECK_RESULT 0 0 0 'Execute clamconf -g clamd.d/scan.conf failed.'
+ actual_result=0
+ expect_result=0
+ mode=0
+ error_log='Execute clamconf -g clamd.d/scan.conf failed.'
+ '[' -z 0 ']'
+ '[' 0 -eq 0 ']'
+ test 0x '!=' 0x
+ return 0
+ clamconf -c /etc/freshclam.conf
+ grep -i 'Build information'
Build information
+ CHECK_RESULT 0 0 0 'Execute clamconf -g freshclam.conf failed.'
+ actual_result=0
+ expect_result=0
+ mode=0
+ error_log='Execute clamconf -g freshclam.conf failed.'
+ '[' -z 0 ']'
+ '[' 0 -eq 0 ']'
+ test 0x '!=' 0x
+ return 0
+ clamconf -c /etc/mail/clamav-milter.conf
+ grep -i 'Build information'
Build information
+ CHECK_RESULT 0 0 0 'Execute clamconf -g mail/clamav-milter.conf failed.'
+ actual_result=0
+ expect_result=0
+ mode=0
+ error_log='Execute clamconf -g mail/clamav-milter.conf failed.'
+ '[' -z 0 ']'
+ '[' 0 -eq 0 ']'
+ test 0x '!=' 0x
+ return 0
+ clamconf -V
+ grep 'Clam AntiVirus Configuration Tool'
Clam AntiVirus Configuration Tool 0.103.6
+ CHECK_RESULT 0 0 0 'Check clamconf version failed.'
+ actual_result=0
+ expect_result=0
+ mode=0
+ error_log='Check clamconf version failed.'
+ '[' -z 0 ']'
+ '[' 0 -eq 0 ']'
+ test 0x '!=' 0x
+ return 0
+ clamconf -h

                       Clam AntiVirus: Configuration Tool 0.103.6
           By The ClamAV Team: https://www.clamav.net/about.html#credits
           (C) 2022 Cisco Systems, Inc.

    --help                 -h         Show this help
    --version              -V         Show version
    --config-dir=DIR       -c DIR     Read configuration files from DIR
    --non-default          -n         Only display non-default settings
    --generate-config=NAME -g NAME    Generate example config file

+ CHECK_RESULT 0 0 0 'Check clamconf help message failed.'
+ actual_result=0
+ expect_result=0
+ mode=0
+ error_log='Check clamconf help message failed.'
+ '[' -z 0 ']'
+ '[' 0 -eq 0 ']'
+ test 0x '!=' 0x
+ return 0
+ clamconf -n
+ grep -i CFLAGS
CFLAGS: -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/generic-hardened-cc1 -fasynchronous-unwind-tables -fstack-clash-protection  -D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE -D_FILE_OFFSET_BITS=64
Configure: '--build=riscv64-openEuler-linux-gnu' '--host=riscv64-openEuler-linux-gnu' '--program-prefix=' '--disable-dependency-tracking' '--prefix=/usr' '--exec-prefix=/usr' '--bindir=/usr/bin' '--sbindir=/usr/sbin' '--sysconfdir=/etc' '--datadir=/usr/share' '--includedir=/usr/include' '--libdir=/usr/lib64' '--libexecdir=/usr/libexec' '--localstatedir=/var' '--sharedstatedir=/var/lib' '--mandir=/usr/share/man' '--infodir=/usr/share/info' '--enable-milter' '--disable-clamav' '--disable-static' '--disable-zlib-vcheck' '--disable-unrar' '--enable-id-check' '--enable-dns' '--with-dbdir=/var/lib/clamav' '--with-group=clamav' '--with-user=clamav' '--disable-rpath' '--disable-silent-rules' '--enable-clamdtop' 'build_alias=riscv64-openEuler-linux-gnu' 'host_alias=riscv64-openEuler-linux-gnu' 'CXXFLAGS=-O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/generic-hardened-cc1 -fasynchronous-unwind-tables -fstack-clash-protection -fexceptions' 'LDFLAGS=-Wl,-z,relro   -Wl,-z,now -specs=/usr/lib/rpm/generic-hardened-ld -Wl,--as-needed' 'CFLAGS=-O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/generic-hardened-cc1 -fasynchronous-unwind-tables -fstack-clash-protection' 'PKG_CONFIG_PATH=:/usr/lib64/pkgconfig:/usr/share/pkgconfig'
+ CHECK_RESULT 0 0 0 'Check clamconf non-default config failed.'
+ actual_result=0
+ expect_result=0
+ mode=0
+ error_log='Check clamconf non-default config failed.'
+ '[' -z 0 ']'
+ '[' 0 -eq 0 ']'
+ test 0x '!=' 0x
+ return 0
+ LOG_INFO 'End to run test.'
+ message='End to run test.'
+ python3 /root/GitRepo/mugen-riscv/libs/locallibs/mugen_log.py --level info --message 'End to run test.'
Thu Jan  5 23:04:57 2023 - INFO  - End to run test.
+ CASE_RESULT 0
+ case_re=0
+ test -z ''
+ test 0 -eq 0
+ LOG_INFO 'succeed to execute the case.'
+ message='succeed to execute the case.'
+ python3 /root/GitRepo/mugen-riscv/libs/locallibs/mugen_log.py --level info --message 'succeed to execute the case.'
Thu Jan  5 23:04:58 2023 - INFO  - succeed to execute the case.
+ exec_result=
+ exit 0
+ post_test
+ LOG_INFO 'Start to restore the test environment.'
+ message='Start to restore the test environment.'
+ python3 /root/GitRepo/mugen-riscv/libs/locallibs/mugen_log.py --level info --message 'Start to restore the test environment.'
Thu Jan  5 23:04:59 2023 - INFO  - Start to restore the test environment.
+ DNF_REMOVE
+ node=1
+ pkg_list=
+ mode=0
+ [[ -z /tmp/tmp4qkzq9pg ]]
+ '[' 0 -ne 0 ']'
+ '[' 1 == 0 ']'
+ python3 /root/GitRepo/mugen-riscv/libs/locallibs/rpm_manage.py remove --node 1 --pkgs '' --tempfile /tmp/tmp4qkzq9pg
+ '[' 0 -ne 0 ']'
+ LOG_INFO 'End to restore the test environment.'
+ message='End to restore the test environment.'
+ python3 /root/GitRepo/mugen-riscv/libs/locallibs/mugen_log.py --level info --message 'End to restore the test environment.'
Thu Jan  5 23:05:35 2023 - INFO  - End to restore the test environment.
